<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://fonts.googleapis.com/css?family=Varela Round' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

    <title>SignSpeak</title>



    <style>
        /* a:hover {
            font-weight: bold;
            color: rgb(6, 6, 235);
        } */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
            
.navbar-brand img {
    max-height: 50px; /* Adjust as needed */
}

.navbar-nav .nav-item .nav-link {
    color: #000; /* Adjust text color */
}

.dropdown-menu {
    background-color: #1f1c1c94; /* Adjust background color */
    box-shadow: 0px 8px 16px 0px rgba(28, 6, 6, 0.2);
}

.dropdown-item {
    color: #eadddb; /* Adjust dropdown item text color */
    padding: 12px 16px;
}


        .navbar {
            background-color: #eb38a3;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand img {
            height: 50px;
            width: auto;
        }

        .navbar-nav {
            display: flex;
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        .nav-item {
            margin-right: 10px;
        }

        .nav-link {
            color: #fff;
            text-decoration: none;
            padding: 10px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background-color: #71a0eb;
            border-radius: 3px;
        }

        .login-btn {
            background-color: #5299e4;
            border-radius: 5px;
        }

        .login-btn:hover {
            background-color: #0d6ac7;
        }

        .collapse {
            display: flex;
            flex-basis: auto;
        }

        .collapse.navbar-collapse {
            flex-grow: 1;
            flex-basis: auto;
        }

        .navbar-toggler {
            border: none;
            cursor: pointer;
            background-color: blue;
            color: #f0eeee;
            font-size: 18px;
        }

        .navbar-toggler:focus {
            outline: none;
        }

        @media screen and (max-width: 768px) {
            .navbar-nav {
                flex-direction: column;
                align-items: flex-start;
            }

            .nav-item {
                margin-right: 0;
                margin-bottom: 5px;
            }
        }


        a {
            text-decoration: none;
            color: rgb(64, 11, 236);
            font-size: 16px;
            transition: font-weight 0.3s, color 0.3s;
        }
        a:hover {
            font-weight: bold;
            color: rgb(6, 6, 235);
        }



        #container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }


        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #71a0eb;
            color: #fff;
        }


    </style>
</head>

<body>
    

    <!-- Navbar -->
<!-- Navbar -->
    <!-- Navbar -->
<!-- Navbar -->
<!-- Navbar -->
<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="#"><img src="../../static/assets/aa.png" alt="Logo"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'SignApp' %}" style="color: #e9ecef;">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'test' %}" style="color: #e9ecef;">Learning</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'index' %}" style="color: #e9ecef;">Testing</a>
                </li>

                {% if user.is_authenticated %}
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'DashBoard' %}" style="color: #e9ecef;">DashBoard</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: #e9ecef;">
                        <img src="../../static/assets/dummy.png" alt="User Image" class="rounded-circle" width="30" height="30">
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                        <a class="dropdown-item" href="#">
                            <img src="../../static/assets/dummy.png" alt="User Image" class="rounded-circle" width="100" height="100">
                            <!-- <span>{{ user.username }}</span> -->
                        </a>
                        <div class="dropdown-divider"></div>
                        <form id="logout-form" action="{% url 'logout' %}" method="post">
                            {% csrf_token %}
                            <a class="nav-link login-btn" href="{% url 'updatepass' %}" style="color: #e9ecef; width: 14vw; background-color: #eb38a3; text-align: center;">Update Password</a>
                            <button type="submit" class="nav-link login-btn" style="color: #e9ecef; width: 14vw; background-color: #eb38a3;">Logout</button>
                            
                        </form>
                    </div>
                </li>
                {% else %}
                <li class="nav-item">
                    <a class="nav-link login-btn" href="{% url 'login' %}" style="color: #e9ecef;">Login</a>
                </li>
                {% endif %}

            </ul>
        </div>
    </div>
</nav>
<!-- End of Navbar -->

<!-- End of Navbar -->
<button onclick="downloadPdf()" style="position: fixed; margin-left: 87%; margin-top: 2vw;">Download as PDF</button>





<script>

    function downloadPdf() {
      const { jsPDF } = window.jspdf;
      const input = document.getElementById('container');// Capture the entire page. Adjust the selector as needed.

      html2canvas(input)
        .then((canvas) => {
          const imgData = canvas.toDataURL('image/png');
          const pdf = new jsPDF('p', 'mm', 'a4');
          const pdfWidth = pdf.internal.pageSize.getWidth();
          const pdfHeight = pdf.internal.pageSize.getHeight();

          // Calculate the image height to maintain aspect ratio
          const imgProps = pdf.getImageProperties(imgData);
          const imgHeight = (imgProps.height * pdfWidth) / imgProps.width;

          // Add the image to the PDF
          pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, imgHeight);
          // Save the PDF
          pdf.save('download.pdf');
        })
        .catch((err) => {
          console.error('Error generating PDF:', err);
        });
    }


    const conversion = {
            '1': 'ا',
            '2': 'ب',
            '3': 'پ',
            '4': 'ت',
            '5': 'ٹ',
            '6': 'ث',
            '7': 'چ',
            '8': 'ح',
            '9': 'خ',
            '10': 'د',
            '11': 'ڈ',
            '12': 'ذ',
            '13': 'ر',
            '14': 'ز',
            '15': 'ژ',
            '16': 'س',
            '17': 'ش',
            '18': 'ص',
            '19': 'ض',
            '20': 'ط',
            '21': 'ظ',
            '22': 'ع',
            '23': 'غ',
            '24': 'ف',
            '25': 'ق',
            '26': 'ک',
            '27': 'گ',
            '28': 'ل',
            '29': 'م',
            '30': 'ن',
            '31': 'و',
            '32': 'ء',
            '33': 'ی',
            '34': 'ے',
        };
    // Initialize an array to store the times
    var timesArray = [];

    // Function to check if a time exists in the array
    function timeExists(time) {
        return timesArray.includes(time);
    }

    // Function to add a time to the array
    function addTime(time) {
        if (!timeExists(time)) {
            timesArray.push(time);
            return true;
        }
        return false;
    }
</script>

<div id="container">
    <h1 style="text-align: center;">DashBoard</h1>
<table>
    <thead>
        <tr>
            <th style="display:none;"></th>
            <th>Date</th>
            <th>Time</th>
            <th>Letter</th>
            <th>Total Attempts</th>
            <th>Correct Attempts</th>
            <th>Incorrect Attempts</th>
            <th>Accuracy</th>
        </tr>
    </thead>
    <tbody>
    {% for row in data %}
        <script>
        
            // Get the current row time
            var currentTime = "{{ row.c_time }}";


        


            // Check if the time exists in the array
            if (addTime(currentTime)) {
                var buttonPressed = "{{ row.button_pressed }}";
                var buttonPressedString = conversion[buttonPressed];
                document.write(`
                    <tr>
                        <td style="display: none;">{{ row.id }}</td>
                        <td>{{ row.c_date }}</td>
                        <td>{{ row.c_time }}</td>
                        <td>${buttonPressedString}</td>
                        <td>{{ row.total_predictions }}</td>
                        <td>{{ row.correct_predictions }}</td>
                        <td>{{ row.incorrect_predictions }}</td>
                        <td>{{ row.accuracy }}</td>
                    </tr>
                `);
            }
        </script>
    </tbody>
    {% endfor %}
</table>
</div>




<!-- End of Navbar -->
</body>
</html>